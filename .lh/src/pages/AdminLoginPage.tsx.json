{
    "sourceFile": "src/pages/AdminLoginPage.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1761127398983,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1761127398983,
            "name": "Commit-0",
            "content": "import React, { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport '../styles/AdminLogin.css';\r\n\r\nconst AdminLoginPage = () => {\r\n  const [form, setForm] = useState({ email: '', password: '' });\r\n  const [status, setStatus] = useState('');\r\n  const [error, setError] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const navigate = useNavigate();\r\n\r\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    setForm({ ...form, [e.target.name]: e.target.value });\r\n    setError('');\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setStatus('Logging in...');\r\n    setError('');\r\n    setIsLoading(true);\r\n    \r\n    try {\r\n      const controller = new AbortController();\r\n      const timeout = setTimeout(() => controller.abort(), 5000);\r\n\r\n      const response = await fetch('/api/admin/login', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          email: form.email,\r\n          password: form.password\r\n        }),\r\n        signal: controller.signal\r\n      });\r\n\r\n      clearTimeout(timeout);\r\n      \r\n      const data = await response.json();\r\n      \r\n      if (response.ok && data.success) {\r\n        console.log('Admin login successful:', data.admin);\r\n        \r\n        // Store admin info in localStorage\r\n        localStorage.setItem('adminUser', JSON.stringify(data.admin));\r\n        localStorage.setItem('isAdmin', 'true');\r\n        \r\n        setStatus('Login successful! Redirecting...');\r\n        setTimeout(() => {\r\n          navigate('/admin/dashboard');\r\n        }, 500);\r\n      } else {\r\n        setError(data.error || 'Invalid admin credentials');\r\n        setStatus('');\r\n      }\r\n    } catch (err) {\r\n      console.error('Admin login error:', err);\r\n      if (err instanceof Error && err.name === 'AbortError') {\r\n        setError('Request timeout. Please check your connection.');\r\n      } else {\r\n        setError('Failed to connect to server. Please try again.');\r\n      }\r\n      setStatus('');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"admin-login-container\">\r\n      <div className=\"admin-login-card\">\r\n        <div className=\"admin-login-header\">\r\n          <div className=\"admin-icon\">\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n              <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z\"/>\r\n            </svg>\r\n          </div>\r\n          <h1>Admin Portal</h1>\r\n          <p>Sign in to access the dashboard</p>\r\n        </div>\r\n\r\n        <form onSubmit={handleSubmit} className=\"admin-login-form\">\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"email\">Email Address</label>\r\n            <input\r\n              type=\"email\"\r\n              id=\"email\"\r\n              name=\"email\"\r\n              value={form.email}\r\n              onChange={handleChange}\r\n              placeholder=\"admin@mapit.com\"\r\n              required\r\n              autoComplete=\"email\"\r\n              disabled={isLoading}\r\n            />\r\n          </div>\r\n\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"password\">Password</label>\r\n            <input\r\n              type=\"password\"\r\n              id=\"password\"\r\n              name=\"password\"\r\n              value={form.password}\r\n              onChange={handleChange}\r\n              placeholder=\"Enter your password\"\r\n              required\r\n              autoComplete=\"current-password\"\r\n              disabled={isLoading}\r\n            />\r\n          </div>\r\n\r\n          {error && (\r\n            <div className=\"alert alert-error\">\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n                <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z\"/>\r\n              </svg>\r\n              {error}\r\n            </div>\r\n          )}\r\n\r\n          {status && !error && (\r\n            <div className=\"alert alert-success\">\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n                <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z\"/>\r\n              </svg>\r\n              {status}\r\n            </div>\r\n          )}\r\n\r\n          <button \r\n            type=\"submit\" \r\n            className=\"btn-admin-login\"\r\n            disabled={isLoading}\r\n          >\r\n            {isLoading ? (\r\n              <>\r\n                <span className=\"spinner\"></span>\r\n                Signing in...\r\n              </>\r\n            ) : (\r\n              'Sign In'\r\n            )}\r\n          </button>\r\n        </form>\r\n\r\n        <div className=\"admin-login-footer\">\r\n          <p>Protected area - Admin access only</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdminLoginPage;\r\n"
        }
    ]
}